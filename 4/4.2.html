<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Precondition and Postcondition - CS449 Textbook Notes</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../overview.html">Overview</a></li><li class="chapter-item expanded affix "><a href="../roadmap.html">Roadmap</a></li><li class="spacer"></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> Introduction</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Software Development Process</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Scrum for Software Development</div></li><li class="chapter-item expanded "><a href="../4/index.html"><strong aria-hidden="true">4.</strong> Fundamentals of Software Design</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../4/4.1.html"><strong aria-hidden="true">4.1.</strong> Basic Design Principles</a></li><li class="chapter-item expanded "><a href="../4/4.2.html" class="active"><strong aria-hidden="true">4.2.</strong> Precondition and Postcondition</a></li><li class="chapter-item expanded "><a href="../4/4.3.html"><strong aria-hidden="true">4.3.</strong> Design By Contract</a></li><li class="chapter-item expanded "><a href="../4/4.4.html"><strong aria-hidden="true">4.4.</strong> Change of Contract</a></li></ol></li><li class="chapter-item expanded "><a href="../5/index.html"><strong aria-hidden="true">5.</strong> Object-Oriented Design</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../5/5.1.html"><strong aria-hidden="true">5.1.</strong> Class Diagrams</a></li><li class="chapter-item expanded "><a href="../5/5.2.html"><strong aria-hidden="true">5.2.</strong> ADTs as the Class Foundation</a></li><li class="chapter-item expanded "><a href="../5/5.3.html"><strong aria-hidden="true">5.3.</strong> Inheritance and Polymorphism</a></li><li class="chapter-item expanded "><a href="../5/5.4.html"><strong aria-hidden="true">5.4.</strong> Design Heuristics</a></li><li class="chapter-item expanded "><a href="../5/5.5.html"><strong aria-hidden="true">5.5.</strong> The SOLID Principles</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Design Patterns and Anti-Patterns</div></li><li class="chapter-item expanded "><a href="../7/index.html"><strong aria-hidden="true">7.</strong> Refactoring for Design Improvement</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../7/7.1.html"><strong aria-hidden="true">7.1.</strong> Code Smells</a></li><li class="chapter-item expanded "><a href="../7/7.2.html"><strong aria-hidden="true">7.2.</strong> Named Refactorings</a></li><li class="chapter-item expanded "><a href="../7/7.3.html"><strong aria-hidden="true">7.3.</strong> Refactoring for Modularity</a></li><li class="chapter-item expanded "><a href="../7/7.4.html"><strong aria-hidden="true">7.4.</strong> Refactoring for High Cohesion</a></li><li class="chapter-item expanded "><a href="../7/7.5.html"><strong aria-hidden="true">7.5.</strong> Refactoring for Loose Coupling</a></li><li class="chapter-item expanded "><a href="../7/7.6.html"><strong aria-hidden="true">7.6.</strong> Refactoring for Encapsulation/Information Hiding</a></li><li class="chapter-item expanded "><a href="../7/7.7.html"><strong aria-hidden="true">7.7.</strong> Refactoring for Inheritance/Polymorphism</a></li><li class="chapter-item expanded "><a href="../7/7.8.html"><strong aria-hidden="true">7.8.</strong> Refactoring to Design Patterns</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.9.</strong> Putting It All Together</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Defensive Design for Security</div></li><li class="chapter-item expanded "><a href="../9/index.html"><strong aria-hidden="true">9.</strong> Software Quality Assurance</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../9/9.1.html"><strong aria-hidden="true">9.1.</strong> Verification and Validation</a></li><li class="chapter-item expanded "><a href="../9/9.2.html"><strong aria-hidden="true">9.2.</strong> Software Testing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../9/9.2.1.html"><strong aria-hidden="true">9.2.1.</strong> Testing vs. Development Processes</a></li><li class="chapter-item expanded "><a href="../9/9.2.2.html"><strong aria-hidden="true">9.2.2.</strong> Test Cases</a></li><li class="chapter-item expanded "><a href="../9/9.2.3.html"><strong aria-hidden="true">9.2.3.</strong> The Test Oracle Problem</a></li><li class="chapter-item expanded "><a href="../9/9.2.4.html"><strong aria-hidden="true">9.2.4.</strong> Testing Strategies</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.2.5.</strong> Testing Levels</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.2.6.</strong> Testing Types</div></li><li class="chapter-item expanded "><a href="../9/9.2.7.html"><strong aria-hidden="true">9.2.7.</strong> The Agile Testing Quadrants</a></li></ol></li><li class="chapter-item expanded "><a href="../9/9.3.html"><strong aria-hidden="true">9.3.</strong> Static Code Analysis</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.4.</strong> Theorem Proving</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.5.</strong> Model Checking</div></li></ol></li><li class="chapter-item expanded "><a href="../10/index.html"><strong aria-hidden="true">10.</strong> Fundamental Testing Techniques</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../10/10.1.html"><strong aria-hidden="true">10.1.</strong> Fault Detection Condition</a></li><li class="chapter-item expanded "><a href="../10/10.2.html"><strong aria-hidden="true">10.2.</strong> Code Coverage</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.3.</strong> Mutation Testing</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.4.</strong> Equivalence Partitioning</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.5.</strong> Boundary Value Analysis</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.6.</strong> Testing with Pre/Postconditions</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.</strong> Test Automation</div></li><li class="chapter-item expanded "><a href="../previous/quizzes.html"><strong aria-hidden="true">12.</strong> Quiz Questions</a></li><li class="chapter-item expanded "><a href="../previous/midterm.html"><strong aria-hidden="true">13.</strong> Midterm Questions</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CS449 Textbook Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="precondition-and-postcondition"><a class="header" href="#precondition-and-postcondition">Precondition and Postcondition</a></h1>
<blockquote>
<p><strong>Precondition</strong></p>
<hr />
<p>The constraints on the method's input and the states of all related objects that must hold before the method is called.</p>
</blockquote>
<p>The precondition involves:</p>
<ul>
<li>explicit parameters</li>
<li>implicit parameters (e.g. instance variables in the same class)</li>
<li>global variables</li>
</ul>
<blockquote>
<p><strong>Postcondition</strong></p>
<hr />
<p>The constraints on the method's output and the states of all related objects that the method guarantees when it returns.</p>
</blockquote>
<p>The postcondition may involve <strong>both</strong></p>
<ul>
<li>what is changed</li>
<li>what remains unchanged</li>
</ul>
<p>The precondition \(P\) and the postcondition \(Q\) of a method \(M\) can be represented by the correctness formula \(\{ P \}M\{ Q \}\), also known as <strong>Hoare Triples</strong>.</p>
<blockquote>
<p>\(\{ P \}M\{ Q \}\) can be read as &quot;any execution of \(M\), starting in a program state where \(P\) holds, will terminate in a program state where \(Q\) holds.&quot;</p>
</blockquote>
<p>Program state is not just limited to the method itself, but <strong>all</strong> relevant objects in the program.</p>
<p>The correctness formula captures <em>semantic</em> properties of the method, meaning it may be independent of the method's implementation details.</p>
<ul>
<li>Consider a <code>Stack</code> object: its <code>pop</code> and <code>peek</code> methods require that the <code>Stack</code> is not empty. That the stack is implemented with a <code>Vector</code> doesn't matter, nor does the actual implementation of <code>pop</code> or <code>peek</code>.</li>
<li>In other words, the precondition and postcondition of a method describe <em>what to do</em> rather than <em>how to do it</em>.</li>
</ul>
<p>Preconditions and postconditions may be specified as:</p>
<ul>
<li>comments in source code</li>
<li>part of the API documentation</li>
<li>executable assertions in source code
<ul>
<li>goal: terminate the program on unexpected failure conditions</li>
<li><strong>NOTE:</strong>
<ul>
<li>assertions should be used to check for conditions that should never occur to identify bugs.</li>
<li><code>assert</code> is not a control structure</li>
<li><code>assert</code> is not an input-checking mechanism</li>
</ul>
</li>
<li>as opposed to exceptions, which handle <em>expected</em> failure conditions</li>
</ul>
</li>
</ul>
<h2 id="assumed-precondition-vs-validated-precondition"><a class="header" href="#assumed-precondition-vs-validated-precondition">Assumed Precondition vs. Validated Precondition</a></h2>
<ul>
<li>Assumed Precondition (<em>demanding</em>)
<ul>
<li>method assumes that the precondition is always satisfied by all clients</li>
<li>clients check for precondition <em>before</em> calling method</li>
<li>adopted in <a href="4.3.html">design by contract</a>, must follow those rules
<ul>
<li><em>only applies in trustworthy environment</em></li>
</ul>
</li>
</ul>
</li>
<li>Validated Precondition (<em>tolerant</em>)
<ul>
<li>the precondition is validated in the method body by some control structure
<ul>
<li>if/then, etc.</li>
</ul>
</li>
<li>often adopted by defensive design to deal with untrusted clients/external environments</li>
<li>very important for safety- and security-critical software</li>
</ul>
</li>
</ul>
<p>Validating a precondition either</p>
<ul>
<li>turns the <em>original</em> precondition into a tautology</li>
<li>converts a partial function<sup class="footnote-reference"><a href="#partial-function">1</a></sup> into a total function<sup class="footnote-reference"><a href="#total-function">2</a></sup></li>
</ul>
<p>Validation turns the original precondition into a part of the actual postcondition with a conditional effect. An assumed precondition/corresponding postcondition of</p>
<pre><code>Precondition:  0 &lt;= row &lt; TOTAL_ROWS and 0 &lt;= column &lt; TOTAL_COLUMNS

Postcondition: return value is either Cell.EMPTY, Cell.CROSS, or Cell.NOUGHT
</code></pre>
<p>when validated becomes</p>
<pre><code>Precondition:  none (tautology, always applicable)

Postcondition: return value is either Cell.EMPTY, Cell.CROSS, or Cell.NOUGHT
               if 0 &lt;= row &lt; TOTAL_ROWS and 0 &lt;= column &lt; TOTAL_COLUMNS
               otherwise null
</code></pre>
<p>When a method declares a precondition, it usually assumes that the client is responsible for validating the precondition.</p>
<p>In Test-Driven Development, the precondition and postcondition change over time as the development process evolves. The pre/postconditions at a specific time only reflect the assumptions behind that current iteration of code.</p>
<h2 id="prepostcondition-specifications"><a class="header" href="#prepostcondition-specifications">Pre/Postcondition Specifications</a></h2>
<p>Pre/postconditions need to be specified rigorously and precisely. This allows us to use the specification to reason about the correctness of an implementation.</p>
<p>Obtaining a precise, rigorous specification isn't a trivial task. Consider the following correct specification for a sorting algorithm (p. 101 contains incorrect examples as well).</p>
<pre><code>Note: count(x, list) returns the number of occurrences of element x in list

Postcondition:
  - p.length = q.length
  - q[i] &lt;= q[i + 1] for any i
  - 0 &lt;= i &lt; q.length - 1 and count(p[j], p) = count(p[j], q), 0 &lt;= j &lt; p.length
</code></pre>
<p>Postcondition specifications need to consider both what should change after a method call <em>and what should remain unchanged</em>.</p>
<p>As a general rule, <strong>don't over-specify</strong> what should remain unchanged. Avoiding all-knowing oracles is an important TDD practice! Checking every detail every time can decrease test efficiency, slowing the iteration speed of TDD (tests should be efficient to be run so frequently).</p>
<h3 id="practice-exercises"><a class="header" href="#practice-exercises">Practice Exercises</a></h3>
<p>Write accurate and meaningful specifications for the following:</p>
<ul>
<li><code>int[] reverse(int[] list)</code> returns the reversed order of all elements in <code>list</code>.</li>
<li><code>int linearSearch(int[] list, int key)</code> returns the index of the first occurrence of <code>key</code> in <code>list</code> or <code>-1</code> if it is not found.</li>
<li><code>bool isVowel(char letter)</code> returns <code>true</code> if <code>letter</code> is a vowel.</li>
<li><code>bool isLeapYear(int year)</code> returns <code>true</code> if it is a leap year.</li>
<li><code>TriangleType reportTriangleType(int a, int b, int c)</code> returns the triangle type for the given sides <code>a</code>, <code>b</code>, and <code>c</code>.
<ul>
<li><code>TriangleType</code> is an enumeration type <code>{SCALENE, ISOSCELES, EQUILATERAL}</code>.</li>
</ul>
</li>
</ul>
<h2 id="footnotes"><a class="header" href="#footnotes">Footnotes</a></h2>
<div class="footnote-definition" id="partial-function"><sup class="footnote-definition-label">1</sup>
<p>A <strong>partial function</strong> is defined for a limited subset of all possible inputs for a given type.</p>
</div>
<div class="footnote-definition" id="total-function"><sup class="footnote-definition-label">2</sup>
<p>A <strong>total function</strong> is defined for all possible inputs for a given type.</p>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../4/4.1.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../4/4.3.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../4/4.1.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../4/4.3.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
